<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yuanhao" />

<meta name="date" content="2018-12-21" />

<title>Annual Lynx Trappings Application</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Annual Lynx Trappings Application</h1>
<h4 class="author"><em>Yuanhao</em></h4>
<h4 class="date"><em>2018-12-21</em></h4>



<p>This vignette introduces the functionality of the <code>harper</code> package for estimating the frequency in the (generalzied) semiparametric harmonic regression model. As an example, we investigate the periodicity of the annual numbers of lynx trappings for 1821â€“1934 in Canada. This dataset is avaiable in R.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#----------Read Data----------#</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(lynx)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">ly &lt;-<span class="st"> </span><span class="kw">log</span>(y)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">n &lt;-<span class="st"> </span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">t &lt;-<span class="st"> </span><span class="dv">1821</span><span class="op">:</span><span class="dv">1934</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">plot</span>(t,y,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;year&quot;</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">     <span class="dt">main =</span> <span class="st">&quot;lynx&quot;</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">plot</span>(t,ly,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;year&quot;</span>,</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">     <span class="dt">main=</span><span class="st">&quot;Log lynx&quot;</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Lynx series and its log transformation" />
<p class="caption">Lynx series and its log transformation</p>
</div>
<div id="semiparametric-harmonic-regression-model" class="section level2">
<h2>Semiparametric Harmonic Regression Model</h2>
<p>The proposed (generalzied) semiparametric harmonic regression model for a periodic series has the following form, <span class="math display">\[E[y_t] = g( A \cos(2\pi\lambda t)+B \sin(2\pi\lambda t) ),\ t=1,...,n,\]</span> where <span class="math inline">\(y_{t}\)</span>â€™s are indepedent, <span class="math inline">\(g(\cdot)\)</span> is an unknown strictly monotone function in the range <span class="math inline">\([0,1]\)</span>, <span class="math inline">\(A^2 + B^2 =1\)</span>, <span class="math inline">\(0&lt;f&lt;0.5\)</span> and <span class="math inline">\(\sigma&gt;0\)</span>.</p>
<p>In this application, we assume that <span class="math inline">\(y_t\)</span>â€™s follow either the Poisson distributions or Gaussian distributions with a constant variance.</p>
</div>
<div id="harmonic-regression" class="section level2">
<h2>Harmonic Regression</h2>
<p>When fitting the harmonic regression model, the function <span class="math inline">\(g(\cdot)\)</span> becomes an identity function. We firstly estimate the frequency by the least-square methods on the log-transformed series. We then fit the series using the generalized linear model by specifying a Gaussian family and a Possion family, respectively.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#----------Fit the harmonic regression----------#</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">## Estimate the frequency (LS)</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(harper)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">lambdaRange &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">/</span>n,<span class="fl">0.5</span><span class="dv">-1</span><span class="op">/</span>n,<span class="dt">length.out =</span> <span class="dv">5</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">LSFit &lt;-<span class="st"> </span><span class="kw">ptestReg</span>(<span class="kw">log</span>(y),<span class="dt">t=</span>t,<span class="dt">method =</span> <span class="st">&quot;LS&quot;</span>,</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">                  <span class="dt">lambdalist=</span>lambdaRange,</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">                  <span class="dt">returnPvalue =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">)</a></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.59    0.02    0.67</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">LSFit<span class="op">$</span>freq</a></code></pre></div>
<pre><code>## [1] 0.1037369</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">## Modeling given the estimated frequency</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y=</span>y,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                <span class="dt">x1=</span><span class="kw">cos</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>LSFit<span class="op">$</span>freq<span class="op">*</span>t),</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                <span class="dt">x2=</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>LSFit<span class="op">$</span>freq<span class="op">*</span>t))</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">fitHarG &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">~</span>x1<span class="op">+</span>x2,<span class="dt">data=</span>X,<span class="dt">family=</span><span class="kw">gaussian</span>())  <span class="co">#the Gaussian case</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">fitHarP &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">~</span>x1<span class="op">+</span>x2,<span class="dt">data=</span>X,<span class="dt">family=</span><span class="kw">poisson</span>())   <span class="co">#the Poisson case</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">## Fitted values at continuous time</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">newt &lt;-<span class="st"> </span><span class="kw">seq</span>(t[<span class="dv">1</span>],t[<span class="kw">length</span>(t)],<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">newX &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x1=</span><span class="kw">cos</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>LSFit<span class="op">$</span>freq<span class="op">*</span>newt),</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">                   <span class="dt">x2=</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>LSFit<span class="op">$</span>freq<span class="op">*</span>newt))</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">predHarG &lt;-<span class="st"> </span><span class="kw">predict</span>(fitHarG,newX,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">predHarP &lt;-<span class="st"> </span><span class="kw">predict</span>(fitHarP,newX,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<p>The estimated frequency using the LS method is 0.1037369.</p>
</div>
<div id="semiparametric-harmonic-regression" class="section level2">
<h2>Semiparametric Harmonic Regression</h2>
<p>When fitting the semiparametric harmonic regression model, the function <span class="math inline">\(g(\cdot)\)</span> needs to be estimated. We firstly estimate the frequency by the rank-based methods on the series. The log transformation is not neccessary because ranks are invariant under monotone transformations. We then fit the series the semiparametric harmonic regression with monotone generalzied additive model. As the harmonic regression model, we specify the distributions of <span class="math inline">\(y_t\)</span>â€™s as a Gaussian family and a Possion family, respectively.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#----------Fit the semiparametric harmonic regression----------#</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">## Estimate the frequency (Rank-based)</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">phiRange &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.99</span>,<span class="dt">by=</span><span class="fl">0.01</span>) </a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">system.time</span>(paraRankLS &lt;-<span class="st"> </span><span class="kw">GetFitRankLS</span>(y,<span class="dt">t=</span>t,lambdaRange,phiRange)) </a></code></pre></div>
<pre><code>##    user  system elapsed 
##   18.86    0.03   19.11</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">paraRankLS[<span class="dv">2</span>,<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## Frequency 
## 0.1037369</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">## Modeling given the estimated frequency</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">fitSHarG &lt;-<span class="st"> </span><span class="kw">semihregScam</span>(y, t, <span class="dt">lambda0=</span>paraRankLS[<span class="dv">2</span>,<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                          <span class="dt">family =</span> <span class="kw">gaussian</span>(), <span class="dt">bs =</span> <span class="st">&quot;mpd&quot;</span>) <span class="co">#the Gaussian case</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">fitSHarP &lt;-<span class="st"> </span><span class="kw">semihregScam</span>(y, t, <span class="dt">lambda0=</span>paraRankLS[<span class="dv">2</span>,<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                          <span class="dt">family =</span> <span class="kw">poisson</span>(), <span class="dt">bs =</span> <span class="st">&quot;mpd&quot;</span>) <span class="co">#the Poisson case</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">## Fitted values at continuous time</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">newt &lt;-<span class="st"> </span><span class="kw">seq</span>(t[<span class="dv">1</span>],t[<span class="kw">length</span>(t)],<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">predSHarG &lt;-<span class="st"> </span><span class="kw">predict</span>(fitSHarG,newt)[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">predSHarP &lt;-<span class="st"> </span><span class="kw">predict</span>(fitSHarP,newt)[,<span class="dv">2</span>]</a></code></pre></div>
<p>The estimated frequency using the rank-based method is 0.1037369, the same as the LS method.</p>
</div>
<div id="visualize-the-fitted-model" class="section level2">
<h2>Visualize the Fitted Model</h2>
<p>Finnaly, we compare the fitted values from the above four models.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------------------------------------------------------- tidyverse 1.2.1 --</code></pre>
<pre><code>## v ggplot2 3.0.0     v purrr   0.2.5
## v tibble  1.4.2     v dplyr   0.7.6
## v tidyr   0.8.2     v stringr 1.3.1
## v readr   1.1.1     v forcats 0.3.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------------------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">nt &lt;-<span class="st"> </span><span class="kw">length</span>(newt)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">LynxVis &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t=</span><span class="kw">rep</span>(<span class="kw">c</span>(t,newt),<span class="dv">4</span>),</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">                      <span class="dt">y=</span><span class="kw">c</span>(y,predHarG,y,predHarP,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">                          y,predSHarG,y,predSHarP),</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                      <span class="dt">Method=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Harmonic(G)&quot;</span>,<span class="st">&quot;Harmonic(P)&quot;</span>,</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">                                   <span class="st">&quot;Semi(G)&quot;</span>,<span class="st">&quot;Semi(P)&quot;</span>),<span class="dt">each=</span>n<span class="op">+</span>nt),</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">                      <span class="dt">Type=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;observed&quot;</span>,n),<span class="kw">rep</span>(<span class="st">&quot;fitted&quot;</span>,nt)),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">LynxVis<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">ordered</span>(LynxVis<span class="op">$</span>Type, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;observed&quot;</span>, <span class="st">&quot;fitted&quot;</span>))</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">LynxVis<span class="op">$</span>Method &lt;-<span class="st"> </span><span class="kw">ordered</span>(LynxVis<span class="op">$</span>Method, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Harmonic(G)&quot;</span>, <span class="st">&quot;Semi(G)&quot;</span>,</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">                                                   <span class="st">&quot;Harmonic(P)&quot;</span>,<span class="st">&quot;Semi(P)&quot;</span>))</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="kw">ggplot</span>(LynxVis, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>t, <span class="dt">y=</span>y,<span class="dt">color=</span>Type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape=</span>Type))<span class="op">+</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype=</span>Type),<span class="dt">lwd=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.6</span>) )) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;blank&quot;</span>, <span class="st">&quot;solid&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_grid</span>(Method<span class="op">~</span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Year&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Lynx&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 4524 rows containing missing values (geom_point).</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt="Comparision of the fitted values" />
<p class="caption">Comparision of the fitted values</p>
</div>
</div>
<div id="bootstrap" class="section level2">
<h2>Bootstrap</h2>
<p>Below, we show how to obtain an estimated standard errors of the estimates via the bootstrap method. Since it takes time, we do not evaluate the scripts. The result below is based on a laptop with the cpu i7-4500U.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(lynx)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">n &lt;-<span class="st"> </span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">t &lt;-<span class="st"> </span><span class="dv">1821</span><span class="op">:</span><span class="dv">1934</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">lambdaRange &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">/</span>n,<span class="fl">0.5</span><span class="dv">-1</span><span class="op">/</span>n,<span class="dt">length.out =</span> <span class="dv">5</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">phiRange &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.99</span>,<span class="dt">by=</span><span class="fl">0.02</span>) </a>
<a class="sourceLine" id="cb18-7" data-line-number="7"></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">## Estimation</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9">freqfun1 &lt;-<span class="st"> </span><span class="cf">function</span>(d,inds,lambdaRange){</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">  LSFit &lt;-<span class="st"> </span><span class="kw">ptestReg</span>(d<span class="op">$</span>y[inds],<span class="dt">t=</span>d<span class="op">$</span>t[inds],<span class="dt">method =</span> <span class="st">&quot;LS&quot;</span>,</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">                    <span class="dt">lambdalist=</span>lambdaRange,</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">                    <span class="dt">returnPvalue =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">  LSFit<span class="op">$</span>freq</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb18-15" data-line-number="15"></a>
<a class="sourceLine" id="cb18-16" data-line-number="16">freqfun2 &lt;-<span class="st"> </span><span class="cf">function</span>(d,inds,lambdaRange,phiRange){</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">  paraRankLS &lt;-<span class="st"> </span><span class="kw">GetFitRankLS</span>(d<span class="op">$</span>y[inds],<span class="dt">t=</span>d<span class="op">$</span>t[inds],lambdaRange,phiRange)</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">  paraRankLS[<span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb18-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb18-20" data-line-number="20"></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="co">## Bootstrap using multicores</span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb18-23" data-line-number="23">ncore &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#detectCores() </span></a>
<a class="sourceLine" id="cb18-24" data-line-number="24">cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(ncore) </a>
<a class="sourceLine" id="cb18-25" data-line-number="25"><span class="kw">clusterExport</span>(cl,<span class="st">&quot;ptestReg&quot;</span>)  </a>
<a class="sourceLine" id="cb18-26" data-line-number="26"><span class="kw">clusterExport</span>(cl,<span class="st">&quot;GetFitRankLS&quot;</span>) </a>
<a class="sourceLine" id="cb18-27" data-line-number="27"></a>
<a class="sourceLine" id="cb18-28" data-line-number="28"><span class="co">## LS method</span></a>
<a class="sourceLine" id="cb18-29" data-line-number="29">tc &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</a>
<a class="sourceLine" id="cb18-30" data-line-number="30"><span class="kw">set.seed</span>(<span class="dv">193</span>)</a>
<a class="sourceLine" id="cb18-31" data-line-number="31">bfreqLS &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span><span class="kw">data.frame</span>(<span class="dt">y=</span><span class="kw">log</span>(y),<span class="dt">t=</span>t), <span class="dt">statistic=</span>freqfun1, </a>
<a class="sourceLine" id="cb18-32" data-line-number="32">                <span class="dt">R=</span><span class="dv">500</span>, <span class="dt">sim =</span> <span class="st">&quot;ordinary&quot;</span>,</a>
<a class="sourceLine" id="cb18-33" data-line-number="33">                <span class="dt">parallel=</span><span class="st">&quot;snow&quot;</span>, <span class="dt">ncpus=</span>ncore,<span class="dt">cl=</span>cl,</a>
<a class="sourceLine" id="cb18-34" data-line-number="34">                <span class="dt">lambdaRange=</span>lambdaRange)</a>
<a class="sourceLine" id="cb18-35" data-line-number="35"></a>
<a class="sourceLine" id="cb18-36" data-line-number="36"><span class="kw">proc.time</span>()<span class="op">-</span>tc <span class="co">#</span></a>
<a class="sourceLine" id="cb18-37" data-line-number="37"><span class="co"># user  system elapsed </span></a>
<a class="sourceLine" id="cb18-38" data-line-number="38"><span class="co"># 0.84    0.18  138.17 </span></a>
<a class="sourceLine" id="cb18-39" data-line-number="39">bfreqLS</a>
<a class="sourceLine" id="cb18-40" data-line-number="40"><span class="co"># Bootstrap Statistics :</span></a>
<a class="sourceLine" id="cb18-41" data-line-number="41"><span class="co">#   original       bias    std. error</span></a>
<a class="sourceLine" id="cb18-42" data-line-number="42"><span class="co"># t1* 0.1037369 0.0002357167 0.0004685198</span></a>
<a class="sourceLine" id="cb18-43" data-line-number="43"></a>
<a class="sourceLine" id="cb18-44" data-line-number="44"></a>
<a class="sourceLine" id="cb18-45" data-line-number="45"><span class="co"># Rank-based method</span></a>
<a class="sourceLine" id="cb18-46" data-line-number="46">tc &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</a>
<a class="sourceLine" id="cb18-47" data-line-number="47"><span class="kw">set.seed</span>(<span class="dv">193</span>)</a>
<a class="sourceLine" id="cb18-48" data-line-number="48">bfreqRank &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span><span class="kw">data.frame</span>(<span class="dt">y=</span>y,<span class="dt">t=</span>t), <span class="dt">statistic=</span>freqfun2, </a>
<a class="sourceLine" id="cb18-49" data-line-number="49">                <span class="dt">R=</span><span class="dv">500</span>, <span class="dt">sim =</span> <span class="st">&quot;ordinary&quot;</span>,</a>
<a class="sourceLine" id="cb18-50" data-line-number="50">                <span class="dt">parallel=</span><span class="st">&quot;snow&quot;</span>, <span class="dt">ncpus=</span>ncore,<span class="dt">cl=</span>cl,</a>
<a class="sourceLine" id="cb18-51" data-line-number="51">                <span class="dt">lambdaRange=</span>lambdaRange)</a>
<a class="sourceLine" id="cb18-52" data-line-number="52"></a>
<a class="sourceLine" id="cb18-53" data-line-number="53"><span class="kw">proc.time</span>()<span class="op">-</span>tc <span class="co">#</span></a>
<a class="sourceLine" id="cb18-54" data-line-number="54"><span class="co"># user  system elapsed </span></a>
<a class="sourceLine" id="cb18-55" data-line-number="55"><span class="co"># 6.47    0.32 1499.32 </span></a>
<a class="sourceLine" id="cb18-56" data-line-number="56">bfreqRank</a>
<a class="sourceLine" id="cb18-57" data-line-number="57"><span class="co"># Bootstrap Statistics :</span></a>
<a class="sourceLine" id="cb18-58" data-line-number="58"><span class="co">#   original       bias     std. error</span></a>
<a class="sourceLine" id="cb18-59" data-line-number="59"><span class="co"># t1* 0.1037369 0.0001305769 0.0005192553</span></a>
<a class="sourceLine" id="cb18-60" data-line-number="60"></a>
<a class="sourceLine" id="cb18-61" data-line-number="61"></a>
<a class="sourceLine" id="cb18-62" data-line-number="62"><span class="kw">stopCluster</span>(<span class="dt">cl =</span> cl) <span class="co">#Close the clusters</span></a></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
